# Simple AI Project

The goal of this project is to test implimenting a simple AI interface into a web browser. By doing so I hope to have a better understanding about how to integrate a simple AI model into future projects by getting a clear grasp on how to implement the backend and front end components and logic needed to do so.

Unfortunately the response times of the AI being used can take up to 1 or 2 minuets due to budget constraints on my part and limitations of free software! Please be patient if the AI is taking a moment to load a response especially with images!

## TODO

* styling for website
* fix error messages for edit user
* verify CSRFProtect in the init file on backend - it is currently unused
* add ability for users to add tags to certain pokemon and vet the tags for innapropriate content, spelling errors, etc
* add a dependency that checks to make sure ai response being added to html is safe
* create an all pokemon page
* add redo feature to all AI
* display AI poke in same list as reglar poke
* order poke on profile page by att or dff or date created 
* add error messages that appear when creating a monster
* add error messages when logging in 
* delete poke images after 3 days
* limit the number aof ai monsters to 3 per user
* add loading indicator to create pokemon page
* pass down user state from only nav bar to all other componenets
* implament redux-persist for battles

## Notes

* The input from the user is taken into the backend through the app/api/ai_routes.py file. There it generates the response based on the pre-existing prompt you have written for it. Response is jsonified and returned to frontend
    * this is where you must apply the ai key
    * you must import the AI depency into this file! (AI should be installed in the back end, not needed on front end)
    * remember - all data manipulation happens on the back end, frontend just displays the inf/decides what info is shown based on the data manipulation but doesnt alter data itself

* 4 deepseek roles:
    * system: Used to set instructions or behavior guidelines for the AI assistant at the start of the conversation.
    * user: Represents messages from the human user.
    * assistant: Represents responses generated by the AI model itself. This role is used to provide the AI's answers in the conversation history.
    * tool: Used when the message is generated by or directed to an external tool or function, especially in advanced scenarios involving function calling or tool integrations.

* The response object from deepseek looks as follows:
    ```json
    {
        "id": "...",
        "object": "chat.completion",
        "created": 1234567890,
        "model": "...",
        "choices": [
            {
            "index": 0,
            "message": {
                "role": "assistant",
                "content": "This is the AI's response."
            },
            "finish_reason": "stop"
            }
        ]
    }
    ```
    * this is why when sending the response to the front end you must use ```response.choices[0].message.content```

* when recieving a repsonse object, the front end gets an "ok" property in the response which is a boolean. If the backend had an error that property will automatically be set to false when sent to the frontend

* The query from a user on the frontend must be sent as "POST" fetch request otherwise the backend will not pick up the request

* When using data from DB it is important to re-format that data to be more easily read by the AI model
    *Best is to format the data into strings seperated by newlines
        * Creates a consistent, readable structure that the AI can understand
        * compact while still being informative
        * easy for the AI to reference specific data when answering questions

* One possible solution for creating hyper links within an AI chat is to use dangerouslySetInnerHTML
    * must be contained inside  a span which provides context
    * ```<span dangerouslySetInnerHTML={{ __html: msg.content }} />```
        * __html must always be the key, the value is the message containing the html
    * a potentially dangerous solution - I should look for another way in the future!!!
* Flask DB commands
    * ```flask db downgrade``` removes migrated files
    * ```flask db migrate``` migrate all models
    * ```flask db upgrade``` make sure table layout is up to date
    * ```flask seed all``` populate all tables with data
    * ```flask db stamp head``` forces Alembic to mark your database as being at the latest migration (used when a newly created table does not have a migration file)

* When you use Flask-Migrate (Alembic), it keeps track of which migrations have been applied to your database using a special table (alembic_version). If your migration history gets out of sync-for example, if you manually changed the database or deleted migration files-the system gets confused
    * If the database is not at the latest migration ("head"), Alembic will refuse to generate new migrations and will show errors like "Target database is not up to date"
    * This is because Alembic compares your current database schema (as tracked in alembic_version) with your models to generate new migration scripts. If it thinks your database is behind, it won't proceed

* important to have an authenticatin thunk in layout, prevents the user from being logged out on page reloads!!!

* When setting up a modal and initalizing state ariables for email, username, etc you must use empty strings to initialize! Otherwise you can only type on letter at a time

* ```'pokemon': [poke.to_dict() for poke in self.pokemon]``` and ```'tags': [tag.to_dict() for tag in self.tags]``` cause an an endless recursive loop - when pokemon tries to get all the pokemons data it includes all its tag data which includes all the pokemon data and so on
    * this can be solved by simply assigning one element to the column
    * ```'pokemon_ids': [poke.id for poke in self.pokemon]```

* Pokemon Suggestions agentic AI notes:
    * 3 levels of AI
        1) Parse the users input to the AI for tags which can be used in a query to the DB
        2) Formulate a query to the DB 
        3) Generate a text response to the user with a link to the suggested pokemon

* ```overlaps= ``` is used when defining a db.relationship to inform SQLAlchemy that multiple relationships share or “overlap” the same underlying foreign key columns or association table.
    * When you have several relationships that use the same foreign key columns SQLAlchemy may not be able to tell how to manage updates, inserts, or deletes without potentially conflicting with itself
    * overlaps parameter tells SQLAlchemy which other relationship names are using the same columns or association, so it can coordinate their behavior and avoid emitting warnings
    * commonly used in many-to-many relationships

* Base64 encoding is a way to convert binary data (like an image) into a text format that can be easily transmitted over text-based protocols such as JSON or HTML
    * base64 module in Python provides functions for encoding binary data to printable ASCII characters and decoding it back

* b64encode is a bytes object. .decode('utf-8') converts this bytes object into a regular string, making it suitable for inclusion in JSON responses or for display in web pages

## Backend Installation

1. clone repository and open a WSL terminal

2. run
    ```pip install pipenv``` in the main folder

3. run 
    ```pipenv --python 3.9``` (other versions of python may cause na error)

4. run 
    ```pipenv shell```
    and verify that the .venv file was created sucessfully

5. install all depencies listed in requirement.txt file using the command ```pipenv install -r requirements.txt```

6. Create a __.env__ file in the main folder (outside of app or react/vite) and include 

    ```SECRET_KEY=(set your own secret key) ```
    
    ```DATABASE_URL=sqlite:///dev.db```
    
    ```SCHEMA=flask_schema (or whatever schema name you want)```
    
    ```DEEPSEEK_API_KEY=sk-8d59f937022948ba94960876a0511848```

7. Get into your pipenv, migrate your database, seed your database, and run your
   Flask app:

   ```pipenv shell```

   ```flask db upgrade  ```

   ```flask seed all```

   ```flask run```
   
## Frontend Installation

1. Cd into the react/vite folder and make sure you are using a WSL terminal

2. In the terminal run ```npm install``` and verify that pipfile.lock has been created with all neccessary depencies inside 

3. To run the front end server locally, run ```npm run dev```

## Requirements 

    -i https://pypi.org/simple 

used with pip to instruct it to use the specified URL as the base for finding and downloading Python packages.

ensures that pip looks for packages on the official PyPI repository

    alembic==1.9.2; python_version >= '3.7' 

database migration tool for SQLAlchemy 

    click==8.1.3; python_version >= '3.7' 

package for creating command line interfaces

    flask==2.2.2; python_version >= '3.7' 

web application frame work

    flask-cors==3.0.10 
    
extension for  CORS in FLask apps

    flask-login==0.6.2; python_version >= '3.7' 

Provides user session management for Flask, verifies that user is logged in

    flask-migrate==4.0.2; python_version >= '3.6'

extension that handles SQLAlchemy database migrations for Flask applications.

    flask-sqlalchemy==3.0.2; python_version = '3.7'

Adds SQLAlchemy support to Flask applications, so allowing Web app framework to interact with DB

    flask-wtf==1.1.1; python_version = '3.7'

Simple integration of Flask and WTForms, including CSRF protection.

    greenlet==3.0.1; python_version = '3.7'

A lightweight concurrent programming library, collection of tools and functions that enable programs that can execute multiple tasks simultaneously or manage concurrent processes efficiently. 

enables cooperative multitasking within a single thread. It provides a way to create and manage lightweight coroutines, also known as "greenlets,"

Greenlets are often used in conjunction with other frameworks to provide higher-level abstractions and asynchronous I/O capabilities

    gunicorn==20.1.0; python_version = '3.5'

Web Server Gateway Interface (WSGI). Gunicorn is a robust and efficient solution for deploying Python web applications

A master process manages multiple worker processes,The master process handles worker lifecycle and client connections, Worker processes handle all request processing

USED FOR DEPLOYING WEB APPLICATIONS (not to be confused with Werkzeug)

    importlib-metadata==6.9.0; python_version < '3.10'

A library to access the metadata for Python packages.

Offers a standardized way to retrieve information about packages, such as their version, author, and dependencies. Get details about installed distributions

    itsdangerous==2.1.2; python_version = '3.7'

Various helpers to pass data to untrusted environments securely.

    jinja2==3.1.2; python_version = '3.7'

A template engine for Python, provides a flexible and expressive syntax for creating dynamic content in various formats

Allows creation of base templates that can be extended by child templates, promoting code reuse and maintainability

Supports control structures like loops and conditionals, allowing for complex logic within templates

Helps prevent cross-site scripting (XSS) attacks

Integration with web frameworks: Commonly used with Flask

    mako==1.2.4; python_version = '3.7'

templating language for Python, allows developers to generate dynamic content by combining static templates with data.

contains special syntax for inserting dynamic content, often using curly braces or other delimiters

support for conditional statements, loops, and other programming constructs within the template

provides a familiar syntax that borrows from other templating languages while maintaining close ties to Python's semantics

    markupsafe==2.1.2; python_version = '3.7'

designed to safely handle untrusted strings when generating HTML or XML content.

Provides a mechanism to escape special characters, preventing potential security vulnerabilities such as cross-site scripting (XSS) attacks.

MarkupSafe replaces characters that have special meanings in HTML/XML with their corresponding entity references.

implements a special text object called Markup that wraps escaped strings and prevents double-escaping

 essential to handle user-generated content or dynamic data in HTML/XML output, ensuring that the resulting markup is safe from injection attacks

    python-dateutil==2.8.2; python_version = '2.7' and python_version not in '3.0, 3.1, 3.2'

Extensions to the standard Python datetime module

    python-dotenv==0.21.0; python_version = '3.7'

Reads key-value pairs from a .env file and sets them as environment variables.

    python-editor==1.0.4

Programmatically open an editor, capture the result.

    setuptools==69.0.2; python_version = '3.8'

Easily download, build, install, upgrade, and uninstall Python packages.

    six==1.16.0; python_version = '2.7' and python_version not in '3.0, 3.1, 3.2'

library designed to facilitate compatibility between Python 2 and Python 3. It provides a set of utilities to smooth over the differences between these two major versions of Python

    sqlalchemy==1.4.46; python_version = '2.7' and python_version not in '3.0, 3.1, 3.2, 3.3, 3.4, 3.5'

SQL toolkit and Object-Relational Mapping (ORM) library

    werkzeug==2.2.2; python_version = '3.7'

Web Server Gateway Interface (WSGI) web application library for Python.

offers powerful objects for handling HTTP requests and responses, simplifying the process of working with headers, query arguments, form data, files, and cookies

comes with a built-in threaded WSGI server for local development

FOR BUILDING WEB APPLICATIONS (do not confuse with gunicorn)

    wtforms==3.0.1; python_version = '3.7'

A flexible forms validation and rendering library for Python

    zipp==3.17.0; python_version = '3.8'

allows users to interact with ZIP files

It provides backward compatibility for newer features in older Python versions

supports iterating through ZIP contents, including nested directories

## React-Vite dependencies

    js-cookie

JavaScript API for handling browser cookies

    react

JavaScript library for building user interfaces, known for its component-based architecture 

    react-dom

serves as the bridge between React and the Document Object Model

rendering React components to the DOM and managing updates efficiently

    react-icons

library offering popular icon sets as React components

    react-redux

React bindings for Redux, allowing React components to interact with a Redux store

    react-router-dom

routing for React applications, enabling navigation and URL management

    redux

used for managing application state

    redux-thunk

Middleware for Redux that allows writing action creators that return functions instead of actions,
    
    @types/react and @types/react-dom

TypeScript type definitions

    @vitejs/plugin-react

Vite plugin that provides React refresh support

    eslint

A tool for identifying and reporting on patterns in JavaScript.

    eslint-plugin-react, eslint-plugin-react-hooks, eslint-plugin-react-refresh

ESLint plugins for React-specific linting rules

    redux-logger

middleware for Redux that logs actions and state changes

    vite

build tool for deployment 

    vite-plugin-eslint

Vite plugin to integrate ESLint into the build process    

    reactstrap

provides Bootstrap components as React components, making it easier to use Bootstrap-style UI elements in React apps

    Bootstrap 

widely used open-source CSS framework designed to simplify the development of responsive, mobile-first websites